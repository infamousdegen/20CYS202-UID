<!DOCTYPE html>
<html>
    <head>
        <title>A-Faucet</title>
        <link style="border-radius: 50%" rel="icon" href="./imgs/icon.png">
        <link rel="stylesheet" href="./css/index.css">
    </head>
    <header class="header" style="margin-left:-60px;">
      <div class="nav">


<!--Function to send ether-->
<script type="module">
          import { ethers } from "https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.esm.min.js";
          const AddressValidity = {}

          const sendEther = async() =>{
            const API_KEY = "https://eth-goerli.g.alchemy.com/v2/UUyQAVnk1JZBSMzHOrNYDr5MAPTuj16s";

            const provider = new ethers.provider(API_KEY);

            var address = ethers.utils.getAddress(document.getElementById("EtherWallet"));

            currentTimeStamp = new Date().Now();

            if (!AddressValidity.hasOwnProperty(address)){
              AddressValidity[address] = new Date().Now();
            }

            if((AddressValidity[address]+ 86400) <= currentTimeStamp ){

            if(ethers.utils.isAddress(address)){

              
              const signer = new ethers.Wallet('850fc672a15a70fb71179ea57d754d125ad006c466db11f78713be60d45ea213',provider);
              
              console.log("About to send funds")

              try{
              
              const sendfunds = await signer.sendTransaction({ 
              
                to: address,
              
                value: ethers.utils.parseEther("0.00001")
              
              })

              AddressValidity[address] = currentTimeStamp;
             
              const requiredconfirmations = 2;
              await sendfunds.wait(requiredconfirmations);

            }
            catch(err){
              alert("Transaction sending failed")
            }
            }
            else{
              alert("Invalid address entered");
            }

        }

        else{
          alert("24 hours has not passed since your last claim")
        }
      }


      function CallingSendEther(){
        sendEther();
      }
        
          //
   </script>





      <!-- <div class="container">
        </div> -->
        <img src="./img/icon.png" width="40px" height="40px" style="margin-left: 10px;margin-top: 5px;">
        <figcaption style="margin-top: -35px;font-size:25px;color:white;margin-left:60px">A - FAUCET</figcaption>
      <nav style="margin-left:200px">
              <ul class="navlink" >
                 <li class="li"><a class="a a1"href="./index.html">Home</a></li>
                  <li class="li"><a class="a a1"href="./html/login.html">Login</a></li>
                  <li class="li"><a class="a a1" href="#email">FAQ</a></li>
              </ul>
          </nav>
          </div>
          <a class="cta" href="" style="margin-top:10px"><button class="button">Contact</button></a>
        </div>
      </header>
    <body>
      <center><h1 class="h1">AMRITA FAUCET</h1></center>
      <center><p style="color:white">Fast and reliable. 0.00001 Gorelli Eth/day.</p></center>
      <center><div class="box"></div></center>
      <center>
        <div class="container" style="margin-top: -350px;">
            <form >

                <input type="text" placeholder="Enter your wallet address" class="searchbar" id="EtherWallet">
                <input type = "button" onclick = "CallingSendEther()" value = "Send Ether">
            </form>
        </div>
            <p style="color:white"><a href="" style="text-decoration:none;color:black">Please signup or login</a> with Amrita Faucet to request ETH. It's free!</p>
    </center>
    <center>
      <div class="box1"></div>
      <p style="color:white;font-size:20px;margin-left:-400px;margin-top:-50px">Transcation</p>
      <p style="color:white;font-size:20px;margin-left:450px;margin-top:-45px">Time</p>
      <div class="box2"></div>
      <p style="color:white;font-size:20px;margin-left:-400px;margin-top:-75px">_</p>
    </center>
    </body>
    <footer></footer>
</html>
